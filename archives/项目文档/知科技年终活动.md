业务流程不理解的

- 活动ID（组团红包&红包雨各1个ID做区分）
- 

#### 数据库设计（业务逻辑+设计规约+便于开发   ）

- 新的活动肯定是新的活动ID，复用知科技以前的表
  - 活动ID
  - 玩法介绍
  - 同一IP当日能开团的次数
  - 同一IP累计能开团的次数
  - 同一IP在同一场红包雨中抢到有价值（红包、金币、礼品）的次数，超过返回1金币
  - 同IP当日提现的次数
  
- 新的表表示每一个团（Team）(开团成功的)

  - ID    主键ID
  - 团号   A242324(不可以是主键ID)
  - Leader    团长
  - money    所分金额
  - scale    规模（几人团）
  - 开团时间
  - 过期时间
  - 现有团员
  - 还差多少人
  - 状态（开团成功、成团、组队中、已过期）

- 领取红包记录表

  - 主键ID

  - 团ID
  - 团员ID
  - 领取到的金额
  - 领取时间
  - 剩余金额

  ![image-20211116180157407](C:/Documents(%E8%B5%84%E6%96%99)/Learning/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%B0%8F%E6%B2%88/img/image-20211116180157407.png)

  （开团领红包能否使用redis实现，存储团ID，总金额，团员，领取存储团ID_团员ID_团员名字，value为金额_领取时间）有必要吗？似乎没必要，因为该key只有该团的人才会访问得到

- 每日开团项目如何配置？（未开团和明日可开）

  - 由运营导入（item）--- 后台进行配置

  - 红包团item表

    - 主键ID
    - 邀请人数
    - 瓜分金额
    - 开团数量
    - 团长最大金额
    - 团长最小金额
    - 团员最大金额
    - 团员最小金额

    获取时先获取已开团的团，再获取今天未开团和明天可开团的团？

    ![image-20211116160410289](C:/Documents(%E8%B5%84%E6%96%99)/Learning/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%B0%8F%E6%B2%88/img/image-20211116160410289.png)


-------

  红包雨（可能抢到优惠卷）

  - 主键ID
  - 开始日期
  - 结束日期
  - 开始时间（每个时间段）
  - 红包总金额
  - 红包个数
  - 金币总量
  - 金币总份数
  - 单个红包/金币的最大值
  - 单个红包/金币的最小值
  - 礼品名称
  - 礼品图片
  - 礼品数量
  - 优惠价名称
  - 优惠卷图片
  - 优惠价链接
  - 优惠卷数量

  红包雨记录表（抢到了的）

  - 主键ID
  - 红包雨场次ID
  - 用户ID
  - 领取时间
  - 领取方式（0 金额 1金币）
  - 领取数量
  - 领取的优惠卷
  - 描述

-----

  基础服务

  - 活动用户表
    - 用户ID（对标知科技用户表）
    - 活动ID
    - passportId
    - openid
    - 手机号
    - 用户名
    - 是否新用户（新老用户的定义？活动开始后注册的都是新用户还是只有通过邀请链接下载的才是新用户）
    - 是否参过团
    - 参加活动至今的收益
    - 昨日收益
    - 总提现金额
    - 还可提现金额

--------

 提现配置表

- 起始日期
- 提现金额（有多个）
- 每日可提现金额，超过该金额，当日只可提现金币

提现申请记录表

  提现的逻辑有两个 根据提现方式进行判断，走不同逻辑

- 活动ID

  - 用户ID
  - 风险值（另外使用算法评估）
  - 提现方式（0现金 1金币）
  - （以下字段可通过用户ID从用户表中查）
  - passprtid
  - 用户名
  - 手机号
  - openid
  - ip
  - 申请提现时间
  - 提现金额
  - 提现状态（0审核、1到账、2不通过）
  - 审核人员备注

  #### 接口设计

分为api模块和后台admin模块：

- api模块：/api
- 后台模块：/admin-adi/

##### api

- 用户输入团号搜索，判断用户是否新用户（可参团）

- 参团接口

  - 先认证

  - 几种情况：团号正确/错误、正确团号人员已满、正确团号已过期
  - 参团成功要判断团是否已满，满的话立即分配红包

- 开团接口

  - 先认证
  - 后开团

- 认证服务

  - 判断用户是否登录并微信授权

- 判断团状态

- 获取当前团的信息（团员头像、用户名、团长、还缺多少人、瓜分总金额等）

- 已成团领取红包接口

- 查看团员红包领取记录的接口

- 邀请好友调取跳转微信接口

- 提现接口

- 查看用户收益接口

  

  

  

  

